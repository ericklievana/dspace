\documentclass[hyperref={pdfpagemode=FullScreen},aspectratio=169]{beamer}

\usepackage{tikz}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage{multicol}
\usepackage{hyperref}
\usepackage{adjustbox}
\graphicspath{{./images/}}

\usetheme{CambridgeUS}
\usecolortheme{dolphin}

\setbeamercolor{block title}{use=structure,fg=structure.fg,bg=structure.fg!20!bg}
\setbeamercolor{block body}{parent=normal text,use=block title,bg=block title.bg!50!bg}

\setbeamercolor{block title example}{use=structure,fg=structure.fg,bg=structure.fg!20!bg}
\setbeamercolor{block body example}{parent=normal text,use=block title,bg=block title.bg!50!bg}

\setbeamertemplate{background}{ \begin{tikzpicture}
  \node [opacity=0.2]{\includegraphics[width=\paperwidth,height=\paperheight]{canvasLectura3.jpg}};
\end{tikzpicture} }

\BeforeBeginEnvironment{block}{\begin{adjustbox}{minipage={\linewidth}, center}}
\AfterEndEnvironment{block}{\end{adjustbox}}
\addtobeamertemplate{block begin}{\setlength{\textwidth}{0.9\textwidth}}{}

\title{DSpace: \\Manual de Instalación}

\author[BUAP Facultad de Ciencias de la Computación]{Presenta:\\
García Rojas Alan 201765944\\
Liévana Poy Erick 201742006\\
Lima Estrada Efraín 201705754\\
Reyes Reyes Julián 201643331}

\institute[]{Benemérita Universidad Autónoma de Puebla \\Facultad de Ciencias de la Computación}

\date{\today}

\begin{document}

{ \setbeamertemplate{background}{
  \begin{tikzpicture}
    \node [opacity=0.2]{\includegraphics[width=\paperwidth,height=\paperheight]{IoTCanvas.jpg}};
  \end{tikzpicture}
}
\begin{frame}[t]
  \titlepage
\end{frame} }

\begin{frame}[t]
  \frametitle{Índice}
  \small
  \begin{multicols}{2}
    \tableofcontents[sections={1-3}]
  \end{multicols}
\end{frame}

\begin{frame}[t]
  \frametitle{Índice}
  \small
  \begin{multicols}{2}
    \tableofcontents[sections={4-5}]
  \end{multicols}
\end{frame}

\section{Resumen}
\begin{frame}[t]
  \frametitle{Resumen}
  \begin{itemize}
    \item La presente tiene como finalidad servir como un manual de instalación para el software de repositorios abiertos DSpace.
    \item Esta guía es funcional para la versión 7.0 de DSpace.
    \item A partir de la versión 7 (y superior), la aplicación DSpace se divide en un "frontend" (interfaz de usuario) y un "backend" (API de servidor). La mayoría de las instituciones querrán instalar AMBOS. Sin embargo, puede decidir si ejecutarlos en la misma máquina o en máquinas separadas.
    \item Recomendamos instalar primero el Backend, ya que el Frontend requiere un Backend válido para ejecutarse correctamente.
  \end{itemize}
\end{frame}

\section{Dependencias del Backend}
\begin{frame}[t]
  \vfill
  \center
  \Huge \textbf{Dependencias del Backend}
  \vfill
\end{frame}

\subsection{Sistema Operativo}
\begin{frame}[t]
  \frametitle{Sistema Operativo}
  \begin{itemize}
    \item DSpace puede ser instalado y ejecutado en sistemas operativos basados en UNIX(Linux/Mac OSX) o basados en Microsoft Windows.
    \item Muchas distribuciones de Linux / Unix vienen con algunas de las dependencias a continuación preinstaladas o instaladas fácilmente mediante actualizaciones. Debe consultar la documentación de su distribución particular o los administradores del sistema local para determinar lo que ya está disponible.
  \end{itemize}
  \center
  \includegraphics[height=2cm]{linux.png}
  \includegraphics[height=2cm]{mac.png}
  \includegraphics[height=2cm]{windows.png}
\end{frame}

\subsection{Java Development Kit}
\begin{frame}[t]
  \frametitle{Java Development Kit}
  \begin{itemize}
    \item Java es un lenguaje de programación desarrollado originalmente por Sun Microsystems lanzado en 1995 como un componente central de Sun Microsystems' Java Platform.
    \item Las instrucciones de descarga e instalación de OpenJDK se pueden encontrar aquí \url{http://openjdk.java.net/install/}
    \item Es importante asegurarse de instalar el paquete de desarrollo completo(JDK).
  \end{itemize}
  \center
  \includegraphics[height=2cm]{openjdk.png}
\end{frame}

\subsection{Apache Maven}
\begin{frame}[t]
  \frametitle{Apache Maven}
  \begin{itemize}
    \item Apache Maven es una herramienta de comprensión y gestión de proyectos de software. Basado en el concepto de un modelo de objetos de proyecto (POM), Maven puede administrar la construcción, los informes y la documentación de un proyecto a partir de una pieza central de información.
    \item Maven es necesario en la primera etapa del proceso de compilación para ensamblar el paquete de instalación para su instancia de DSpace.
    \item Apache Maven puede ser descargado desde la siguiente liga: \url{http://maven.apache.org/download.html}
  \end{itemize}
  \center
  \includegraphics[height=1cm]{maven.png}
\end{frame}

\subsection{Apache Ant}
\begin{frame}[t]
  \frametitle{Apache Ant}
  \begin{itemize}
    \item Apache Ant es una biblioteca de Java y una herramienta de línea de comandos cuya misión es impulsar los procesos descritos en los archivos de compilación como objetivos y puntos de extensión que dependen unos de otros.
    \item Se requiere Apache Ant para la segunda etapa del proceso de compilación. Primero, Maven se usa para construir el instalador, después de lo cual Ant se usa para instalar / implementar DSpace en el directorio de instalación.
    \item Apache Ant puede ser descargado desde la siguiente liga: \url{http://ant.apache.org}
  \end{itemize}
  \center
  \includegraphics[height=2cm]{ant.png}
\end{frame}

\subsection{Base de Datos}
\begin{frame}[t]
  \frametitle{Base de Datos}
  \begin{itemize}
    \item DSpace al ser un repositorio, requiere de una base de datos para poder manejar la información. DSpace puede funcionar con:
      \begin{itemize}
        \item PostgreSQL
        \item Oracle DataBase
      \end{itemize}
  \end{itemize}
  \center
  \includegraphics[height=3cm]{database.jpg}
\end{frame}

\subsubsection{PostgreSQL}
\begin{frame}[t]
  \frametitle{PostgreSQL}
  \begin{itemize}
    \item PostgreSQL es un potente sistema de base de datos relacional de objetos de código abierto con más de 30 años de desarrollo activo que le ha ganado una sólida reputación por su fiabilidad, solidez de funciones y rendimiento.
    \item Este manual instalara DSpace con PostgreSQL.
    \item PostgreSQL puede ser descargado de la siguiente liga: \url{http://www.postgresql.org/}
  \end{itemize}
  \center
  \includegraphics[height=2cm]{postgre.png}
\end{frame}

\subsubsection{Oracle DataBase}
\begin{frame}[t]
  \frametitle{Oracle DataBase}
  \begin{itemize}
    \item Oracle Database es un sistema de gestión de base de datos de tipo objeto-relacional desarrollado por Oracle Corporation.
    \item Tenga en cuenta que todo el desarrollo activo de DSpace se produce en PostgreSQL en este momento.
    \item Oracle DataBase puede ser descargado de la siguiente liga: \url{http://www.oracle.com/database/}
  \end{itemize}
  \center
  \includegraphics[height=2cm]{oracle.png}
\end{frame}

\subsection{Apache Solr}
\begin{frame}[t]
  \frametitle{Apache Solr}
  \begin{itemize}
    \item Solr es un motor de búsqueda de código abierto basado en la biblioteca Java del proyecto Lucene, con API en XML/HTTP y JSON, resaltado de resultados, búsqueda por facetas, caché, y una interfaz para su administración.
    \item Es posible que desee leer partes del tutorial de inicio rápido para familiarizarse con el diseño y el funcionamiento de Solr.
    \item Apache Solr puede ser descargado en la siguiente liga: \url{https://solr.apache.org/}
  \end{itemize}
  \center
  \includegraphics[height=2cm]{solr.png}
\end{frame}

\subsection{Apache Tomcat}
\begin{frame}[t]
  \frametitle{Apache Tomcat}
  \begin{itemize}
    \item Apache Tomcat es una tecnología de plataforma Java para extender servlets. Todos los motores de servlet tienen una API común. El componente Conector de servlet de ArcIMS requiere un motor de servlet si su servidor web no admite servlets de forma nativa.
    \item Los servlets de Java son programas que se ejecutan en un servidor web o de aplicaciones y actúan como una capa intermedia entre las solicitudes que provienen de un navegador web u otro cliente HTTP y las bases de datos o aplicaciones en el servidor HTTP.
    \item Apache Tomcat puede ser descargado desde la siguiente liga: \url{http://tomcat.apache.org}
  \end{itemize}
  \center
  \includegraphics[height=2cm]{tomcat.png}
\end{frame}

\section{Instalación de Backend}
\begin{frame}[t]
  \vfill
  \center
  \Huge \textbf{Instalación de Backend}
  \vfill
\end{frame}

\subsection{Preinstalación}
\begin{frame}[t]
  \frametitle{Preinstalación}
  \begin{itemize}
    \item Se deben instalar todas las dependencias del BackEnd antes mencionadas.
    \item Este manual hara la instalación con la base de datos PostgreSQL.
    \item Este manual sera enfocado a una instalación realizada a un Sistema Operativo basado en UNIX, por lo cual tendra comandos propios a este tipo de sistemas.
  \end{itemize}
\end{frame}

\begin{frame}[t]
  \frametitle{Preinstalación}
  \begin{itemize}
    \item Algunas de las dependencias como Apache Tomcat, deben ejecutarse con un usuario que tengas permisos de lectura y escritura en el directorio root de DSpace.
    \item Para lograr eso debe asegurarse de que el propietario de Tomcat también sea propietario del directorio root de DSpace, ó puede crear una nueva cuenta de usuario "\textit{dspaceUsuario}" y asegurarse de que Tomcat también se ejecute desde esa cuenta.
      \begin{block}{Crear un usuario}
        \center
        useradd -m \textbf{dspaceUsuario}
      \end{block}
  \end{itemize}
\end{frame}

\subsection{Descarga de DSpace}
\begin{frame}[t]
  \frametitle{Descarga de DSpace}
  \begin{itemize}
    \item Descargar la ultima version de DSpace. Se puede descargar como .zip o como .tar.gz.
    \item Se puede descargar desde el repositorio en Github de Dspace que se encuentra en la siguiente liga: \url{https://github.com/DSpace/DSpace/releases}
    \item Para poder descomprimir DSpace se pueden usar los comandos:
      \begin{block}{Archivo zip}
        \center
        unzip dspace-7.0.zip
      \end{block}
      \begin{block}{Archivo tar.gz}
        \center
        gunzip -c dspace-7.0.tar.gz | tar -xf -
      \end{block}
  \end{itemize}
\end{frame}

\begin{frame}[t]
  \frametitle{Descarga de DSpace}
  \begin{itemize}
    \item Para facilitar la referencia, nos referiremos a la ubicación de esta versión descomprimida de la versión de DSpace como "\textit{dspace-source}" en el resto de estas instrucciones. Después de descomprimir el archivo, es posible que el usuario desee cambiar la propiedad de la carpeta dspace-7.x al usuario "dspace".
      \begin{block}{Cambio de propietario}
        \center
        chown -c -R \textbf{dspace-source}
      \end{block}
  \end{itemize}
\end{frame}

\subsection{Base de Datos}
\begin{frame}[t]
  \frametitle{Base de Datos}
  \begin{itemize}
    \item Como mencionamos este manual hara una instalación de DSpace con PostgreSQL.
    \item Como requerimiento para la base de datos es necesario instalar y activar la extension \textit{pgcrypto}.
    \item La extensión pgcrypto permite a DSpace crear UUID (identificadores universalmente únicos) para todos los objetos en DSpace, lo que significa que los identificadores de objetos (internos) ahora son únicos a nivel mundial y ya no están vinculados a las secuencias de la base de datos.
    \item En la mayoría de los sistemas operativos Linux, esta extensión se proporciona en el paquete "postgresql-contrib" en su administrador de paquetes. Por lo tanto, asegúrese de haber instalado "postgresql-contrib"
  \end{itemize}
\end{frame}

\begin{frame}[t]
  \frametitle{Base de Datos}
  \begin{itemize}
    \item Cree un usuario en la base de datos de PostgreSQL para DSpace (este usuario puede tener cualquier nombre, pero asumiremos que lo llama "\textit{Usuario}"). Esto es completamente independiente del usuario del sistema operativo dspace creado anteriormente.
      \begin{block}{Crear usuario}
        \center
        createuser --username=postgres --no-superuser --pwprompt \textbf{Usuario}
      \end{block}
    \item Se le pedirá (dos veces) una contraseña para el nuevo usuario de dspace. Luego se le pedirá la contraseña del superusuario de PostgreSQL (postgres). Este ultimo fue creado durante la instalación de PostgreSQL.
  \end{itemize}
\end{frame}

\begin{frame}[t]
  \frametitle{Base de Datos}
  \begin{itemize}
    \item Cree una base de datos de dspace, propiedad del usuario de dspace PostgreSQL. Al igual que en el paso anterior, esto solo puede hacerlo una cuenta de "superusuario" en PostgreSQL.
    \item El dueño de la base de datos es el usuario que creamos en el paso anterior. Y la base de datos se llamara \textit{dspace}
      \begin{block}{Crear usuario}
        \center
        createdb --username=postgres --owner=\textbf{Usuario} --encoding=UNICODE \textbf{dspace}
      \end{block}
    \item Finalmente se debe habilitar en la nueva base de datos de DSpace la extensión \textit{pgcrypto}. Esto solo puede ser realizado por un superusuario.
      \begin{block}{Activar extensión pgcrypto}
        \center
        psql --username=postgres \textbf{dspace}  -c "CREATE EXTENSION pgcrypto;"
      \end{block}
  \end{itemize}
\end{frame}

\subsection{Configuración Inicial}
\begin{frame}[t]
  \frametitle{Configuración Inicial}
  \begin{itemize}
    \item DSpace usara la configuración localizada en "\textit{dspace-source}/dspace/config/local.cfg". El archivo \textit{local.cfg} puede ser usado para guardar cualquier configuración que se desee hacer a la instalación local.
    \item DSpace provee un archivo de configuración de ejemplo ubicado en: "\textit{dspace-source}/dspace/config/local.cfg.EXAMPLE"
    \item CUALQUIER configuración se puede copiar en este archivo local.cfg desde dspace.cfg o cualquier otro archivo * .cfg para anular la configuración predeterminada. Para la instalación inicial de DSpace, hay algunas configuraciones clave que probablemente querrá anular.
  \end{itemize}
\end{frame}

\begin{frame}[t]
  \frametitle{Configuración Inicial}
  \begin{itemize}
    \item dspace.dir - Es el directorio donde DSpace es instalado.
    \item dspace.server.url - URL completa de este backend de DSpace incluido el puerto y cualquier subruta.
    \item dspace.name - nombre "adecuado" legible por humanos de su servidor, p. ej. "Mi Biblioteca Digital".
    \item solr.server - URL completa del servidor Solr. DSpace utiliza Solr con fines de indexación.
    \item default.language - idioma predeterminado para todos los valores de metadatos (el valor predeterminado es "en\_US")
    \item db.url - la URL completa de JDBC a su base de datos (se proporcionan ejemplos en local.cfg.EXAMPLE)
  \end{itemize}
\end{frame}

\begin{frame}[t]
  \frametitle{Configuración Inicial}
  \begin{itemize}
    \item db.driver - qué controlador de base de datos usar, en función de si está utilizando PostgreSQL u Oracle
    \item db.dialect - qué dialecto de la base de datos usar, en función de si está usando PostgreSQL u Oracle
    \item db.username - el nombre de usuario de la base de datos utilizado en el paso anterior.
    \item db.password - la contraseña de la base de datos utilizada en el paso anterior.
    \item db.schema - el esquema de la base de datos que se utilizará (se proporcionan ejemplos en local.cfg.EXAMPLE)
    \item mail.server - nombre de dominio completo de su servidor de correo saliente.
  \end{itemize}
\end{frame}

\begin{frame}[t]
  \frametitle{Configuración Inicial}
  \begin{itemize}
    \item mail.from.address - la dirección "De:" para poner en el correo electrónico enviado por DSpace.
    \item mail.feedback.recipient - buzón de correo para comentarios.
    \item mail.admin - buzón para el administrador del sitio de DSpace.
    \item alert.recipient - buzón de correo para errores / alertas del servidor
    \item registration.notify- buzón de correo electrónico cuando se registran nuevos usuarios
  \end{itemize}
\end{frame}

\subsection{Directorio de Instalación}
\begin{frame}[t]
  \frametitle{Directorio de Instalación}
  \begin{itemize}
    \item Cree el directorio para la instalación del backend de DSpace (es decir, "\textit{dspace}"). Como root (o un usuario con los permisos adecuados), ejecute:
      \begin{block}{Creación del directorio}
        \center
        mkdir \textbf{dspace}
      \end{block}
    \item Asigne al usuario del sistema \textit{dspace} o el que haya creado al inicio de la instalación la propiedad del directorio:
      \begin{block}{Cambiar propietario}
        \center
        chown \textbf{dspaceUsuario} \textbf{dspace}
      \end{block}
  \end{itemize}
\end{frame}

\subsection{Construcción del paquete}
\begin{frame}[t]
  \frametitle{Construcción del paquete}
  \begin{itemize}
    \item Como el usuario del sistema operativo creado para dspace(\textit{dspaceUsuario}) genere el paquete de instalación de DSpace con el siguiente comando:
      \begin{block}{Generación del paquete de instalación}
        \center
        cd \textbf{dspace-source}

        mvn package
      \end{block}
  \end{itemize}
\end{frame}

\subsection{Instalación del Backend de DSpace}
\begin{frame}[t]
  \frametitle{Instalación del Backend de DSpace}
  \begin{itemize}
    \item Como el usuario del sistema operativo creado para dspace(\textit{dspaceUsuario}) instale DSpace en el directorio elegido para la instalación de DSpace, en este caso \textit{dspace}.
      \begin{block}{Instalación}
        \center
        cd \textbf{dspace-source}/dspace/target/dspace-installer

        ant fresh\_install
      \end{block}
    \item Para ver distintas opciones para la instalación se puede ejecutar:
      \begin{block}{Opciones de instalación}
        \center
        ant help
      \end{block}
  \end{itemize}
\end{frame}

\subsection{Inicialización de la Base de Datos}
\begin{frame}[t]
  \frametitle{Inicialización de la Base de Datos}
  \begin{itemize}
    \item Si bien este paso es opcional (ya que la base de datos de DSpace debe autoinicializarse en el primer inicio), siempre es bueno verificar por última vez que la conexión de la base de datos funciona correctamente. Para inicializar la ejecución de la base de datos:
      \begin{block}{Inicializar base de datos}
        \center
        \textbf{dspace}/bin/dspace database migrate
      \end{block}
  \end{itemize}
\end{frame}

\subsection{Implementar la aplicación web del servidor}
\begin{frame}[t]
  \frametitle{Implementar la aplicación web del servidor}
  \begin{itemize}
    \item El backend de DSpace consta de una única aplicación web de "servidor" (en \textit{dspace}/webapps/server). Debe implementar esta aplicación web en su contenedor de servlets para esta instalación se usara Tomcat.
    \item Existen 2 formas de realizar esta acción:
      \begin{enumerate}
        \item Dígale a su instalación de Tomcat dónde encontrar su aplicación web DSpace. Como ejemplo, en el directorio \textit{tomcat}/conf/Catalina/localhost puede agregar archivos similares a los siguientes (pero reemplace \textit{dspace} con su ubicación de instalación):
          \begin{block}{Definir una ruta de contexto para webapp de DSpace: server.xml}
            $<$?xml version='1.0'?$>$\\
            $<$Context\\
            docBase="\textbf{dspace}/webapps/server"/$>$\\
          \end{block}
      \end{enumerate}
  \end{itemize}
\end{frame}

\begin{frame}[t]
  \frametitle{Implementar la aplicación web del servidor}
  \begin{itemize}
    \item []
      \begin{enumerate}
          \setcounter{enumi}{1}
        \item Sencillo y completo. Copia solo (o todas) las aplicaciones web de DSpace que desea usar desde el directorio \textit{dspace}/webapps al directorio apropiado en su instalación de Tomcat.
      \end{enumerate}
      \begin{block}{Copiar todas las aplicaciones web a Tomcat}
        \center
        cp -R \textbf{dspace}/webapps/* tomcat/webapps
      \end{block}
      \begin{block}{Copiar solo la aplicación web del servidor a Tomcat}
        \center
        cp -R \textbf{dspace}/webapps/server tomcat/webapps*
      \end{block}
  \end{itemize}
\end{frame}

\subsection{Nucleos de Solr}
\begin{frame}[t]
  \frametitle{Nucleos de Solr}
  \begin{itemize}
    \item La instalación de DSpace crea un conjunto de cuatro núcleos Solr vacíos ya configurados. Para su uso es necesario copiarlos del directorio "\textit{dspace}/solr" a un directorio donde la instancia de Solr pueda detectarlos esto depende del directorio de Solr por el momento nos referiremos a este directorio como "\textit{solr}" y ademas reiniciar el servicio de Solr.
      \begin{block}{Copiar archivos de Solr}
        \center
        cp -R \textbf{dspace}/solr/* \textbf{solr}/server/solr/configsets

        chown -R solr:solr \textbf{solr}/server/solr/configsets
      \end{block}
      \begin{block}{Iniciar o Reiniciar Solr}
        \center
        \textbf{solr}/bin/solr restart
      \end{block}
  \end{itemize}
\end{frame}

\begin{frame}[t]
  \frametitle{Nucleos de Solr}
  \begin{itemize}
    \item Puede verificar el estado de Solr y sus nuevos núcleos DSpace utilizando su interfaz web administrativa. Vaya a http://localhost:8983/solr/ para ver si Solr está funcionando bien, luego mire los núcleos seleccionando (a la izquierda) Core Admin o usando la lista desplegable Core Selector.
  \end{itemize}
\end{frame}

\subsection{Crear una cuenta de Administrador}
\begin{frame}[t]
  \frametitle{Crear una cuenta de Administrador}
  \begin{itemize}
    \item Se puede crear una cuenta de administrador para DSpace con el siguiente comando:
      \begin{block}{Crear Cuenta Administrador}
        \center
        \textbf{dspace}/bin/dspace create-administrator
      \end{block}
  \end{itemize}
\end{frame}

\subsection{Primer inicio}
\begin{frame}[t]
  \frametitle{Primer inicio}
  \begin{itemize}
    \item Reinicie Tomcat para cargar de nuevo las configuraciónes:
      \begin{block}{Reinicio de Tomcat}
        \center
        \textbf{tomcat}/bin/tomcat restart
      \end{block}
    \item Ingrese a las siguientes urls:
      \begin{itemize}
        \item REST API: \url{http://dspace.myu.edu:8080/server/}
        \item OAI-PMH: \url{http://dspace.myu.edu:8080/server/oai/request?verb=Identify}
      \end{itemize}
    \item Para saber si su instalación funciona correctamente puede entrar a la siguiente liga para compararla: \url{https://api7.dspace.org/server/}
  \end{itemize}
\end{frame}

\subsection{Agregando soporte https}
\begin{frame}[t]
  \frametitle{Agregando soporte https}
  \begin{itemize}
    \item La ejecución del DSpace Backend en HTTP y el puerto 8080 solo se puede usar para entornos de desarrollo local, donde se ejecuta la interfaz de usuario y la API REST desde la misma máquina, y solo se accede a ellos a través de las URL del host local.
    \item Para la compatibilidad con HTTPS, recomendamos instalar Apache HTTPD o Nginx, configurar SSL en ese nivel y enviar todas las solicitudes a su instalación de Tomcat. Tenga en cuenta que si desea alojar tanto el DSpace Backend como el Frontend en el mismo servidor, puede usar una instalación de Apache HTTPD o Nginx para administrar HTTPS / SSL y el proxy para ambos.
    \item En esta guía se usara Apache HTTPD.
  \end{itemize}
\end{frame}

\begin{frame}[t]
  \frametitle{Agregando soporte https}
  \begin{itemize}
    \item Descargue e instale Apache HTTPD desde la siguiente liga: \url{https://httpd.apache.org/}
    \item Instale los módulos \textit{mod\_proxy} y \textit{mod\_proxy\_ajp} con el siguiente comando:
      \begin{block}{Instalación de los módulos}
        \center
        sudo en2mod proxy

        sudo a2enmod proxy\_ajp
      \end{block}
    \item Reinicie Apache
  \end{itemize}
\end{frame}

\begin{frame}[t]
  \frametitle{Agregando soporte https}
  \begin{itemize}
    \item Para que mod\_proxy\_ajp se comunique con Tomcat, deberá habilitar el conector AJP de Tomcat en el server.xml de su Tomcat.
      \begin{block}{Habilitar Tomcat AJP}
        $<$Connector protocol="AJP/1.3" port="8009" redirectPort="8443" URIEncoding="UTF-8"/$>$
      \end{block}
    \item Ahora, configure un nuevo VirtualHost para su sitio (usando HTTPS / puerto 443) que envía todas las solicitudes al conector AJP de Tomcat (que se ejecuta en el puerto 8009)
  \end{itemize}
\end{frame}

\begin{frame}[t]
  \frametitle{Agregando soporte https}
  \begin{itemize}
    \item []
      \begin{block}{Configurando el virtual host}
        $<$VirtualHost \_default\_:443$>$\\
        SSLEngine on\\
        SSLCertificateFile [full-path-to-PEM-cert]\\
        SSLCertificateKeyFile [full-path-to-cert-KEY]\\
        ProxyPass /server ajp://localhost:8009/server\\
        ProxyPassReverse /server ajp://localhost:8009/server\\
        $<$/VirtualHost$>$
      \end{block}
    \item Después de cambiar a HTTPS, asegúrese de volver atrás y actualizar las URL (por ejemplo, dspace.server.url) en su local.cfg para que coincida con la nueva URL de su backend. Esto requerirá reiniciar Tomcat brevemente.
  \end{itemize}
\end{frame}

\section{Dependencias del Frontend}
\begin{frame}[t]
  \vfill
  \center
  \Huge \textbf{Dependencias del Frontend}
  \vfill
\end{frame}


\subsection{Node.js}
\begin{frame}[t]
  \frametitle{Node.js}
  \begin{itemize}
    \item Node.js es un entorno en tiempo de ejecución multiplataforma, de código abierto, para la capa del servidor basado en el lenguaje de programación JavaScript, asíncrono, con E/S de datos en una arquitectura orientada a eventos y basado en el motor V8 de Google.
    \item Puede descargar Node.js asi como sus instrucciones de instalación en la siguiente liga: \url{https://nodejs.org/en/}
  \end{itemize}
  \center
  \includegraphics[height=3cm]{node.png}
\end{frame}

\subsection{Yarn}
\begin{frame}[t]
  \frametitle{Yarn}
  \begin{itemize}
    \item Yarn es un administrador de paquetes para su código. Permite usar y compartir (por ejemplo, JavaScript) código con otros desarrolladores de todo el mundo. Yarn hace esto de forma rápida, segura y confiable.
    \item DSpace funciona solo con la versión 1.x de Yarn.
    \item Puede instalar Yarn, despues de instalar Node.js con el comando:
      \begin{block}{Instalar Yarn}
        \center
        npm install --global yarn
      \end{block}
  \end{itemize}
  \center
  \includegraphics[height=2cm]{yarn.png}
\end{frame}

\subsection{PM2}
\begin{frame}[t]
  \frametitle{PM2}
  \begin{itemize}
    \item En escenarios de producción, recomendamos encarecidamente iniciar/detener la interfaz de usuario con un administrador de procesos Node.js. En esta guía recomendamos usar \textit{PM2}.
    \item Al igual que Yarn puede instalar PM2 despues de instalar Node.js con el siguiente comando:
      \begin{block}{Instalación PM2}
        \center
        npm install --global pm2
      \end{block}
  \end{itemize}
  \center
  \includegraphics[height=2cm]{pm2.png}
\end{frame}

\section{Instalación del Frontend}
\begin{frame}[t]
  \vfill
  \center
  \Huge \textbf{Instalación del Frontend}
  \vfill
\end{frame}

\subsection{Preinstalación}
\begin{frame}[t]
  \frametitle{Preinstalación}
  \begin{itemize}
    \item Primero, instale todos los requisitos de frontend enumerados anteriormente y verifique que la API de backend/REST sea de acceso público.
    \item Descargue la última versión de dspace-angular del repositorio de GitHub de DSpace. Puede elegir descargar el archivo zip o tar.gz proporcionado por GitHub, o puede usar "git" para verificar la etiqueta apropiada (por ejemplo, dspace-7.0) o rama.
    \item Instale todas las dependencias locales necesarias ejecutando lo siguiente desde el directorio "dspace-angular" descomprimido
      \begin{block}{Instalando Dependencias}
        \center
        yarn install
      \end{block}
  \end{itemize}
\end{frame}

\subsection{Creando archivo de Configuración}
\begin{frame}[t]
  \frametitle{Creando archivo de Configuración}
  \begin{itemize}
    \item Cree un archivo de configuración de producción en \textit{dspace-angular}/src/environments/environment.prod.ts.
    \item Es posible que desee utilizar \textit{environment.template.ts} como punto de partida. Este archivo \textit{environment.prod.ts} se puede utilizar para anular cualquiera de las configuraciones predeterminadas especificadas en \textit{environment.common.ts}
    \item Como mínimo, este archivo DEBE incluir las secciones "ui" y "rest" similares a las siguientes:
  \end{itemize}
\end{frame}

\begin{frame}[t]
  \frametitle{Creando archivo de Configuración}
  \begin{itemize}
    \item La sección UI define dónde desea que Node.js se ejecute / responda. A menudo es una URL de host local, especialmente si está utilizando un proxy.
      \begin{block}{Configuración de UI}
        ui: \{\\
        ssl: false,\\
        host: 'localhost',\\
        port: 4000,\\
        nameSpace: '$/$'\\
        \},
      \end{block}
  \end{itemize}
\end{frame}

\begin{frame}[t]
  \frametitle{Creando archivo de Configuración}
  \begin{itemize}
    \item La configuración de REST DEBE corresponder a la URL principal del backend. Por lo general, esto significa que deben mantenerse sincronizados con el valor de "dspace.server.url" en el archivo local.cfg del backend.
      \begin{block}{Configuración de REST}
        rest: \{\\
        ssl: true,\\
        host: 'api.mydspace.edu',\\
        port: 443,\\
        nameSpace: '$/$server'\\
        \}
      \end{block}
  \end{itemize}
\end{frame}


\subsection{Compilar la Interfaz de Usuario}
\begin{frame}[t]
  \frametitle{Compilar la Interfaz de Usuario}
  \begin{itemize}
    \item Cree la interfaz de usuario para la producción. Esto usa su environment.prod.ts y el código fuente para crear una versión compilada de la interfaz de usuario en la carpeta \textit{dspace-angular}/dist
    \item Puede hacerlo con el siguiente comando:
      \begin{block}{Compilación de la interfaz}
        \center
        yarn run build:prod
      \end{block}
    \item Si cambia ó actualiza su \textit{environment.prod.ts}, deberá reconstruir la aplicación de la interfaz de usuario, vuelva a ejecutar este comando.
  \end{itemize}
\end{frame}

\subsection{Configuración de PM2}
\begin{frame}[t]
  \frametitle{Configuración de PM2}
  \begin{itemize}
    \item Cree un archivo de configuración JSON que describa cómo ejecutar nuestra aplicación de interfaz de usuario.
    \item No es necesario que esté en el mismo directorio que la base de código dspace-angular.
      \begin{block}{Archivo de configuración PM2: dspace-angular.json}
        \{ "apps": [ \{\\
        "name": "dspace-angular",\\
        "cwd": "/home/dspace/dspace-angular",\\
        "script": "yarn",\\
        "args": "run serve:ssr",\\
        "interpreter": "none"\\
        \} ] \}
      \end{block}
  \end{itemize}
\end{frame}

\begin{frame}[t]
  \frametitle{Configuración de PM2}
  \begin{itemize}
    \item Ahora, inicie la aplicación usando PM2 usando el archivo de configuración que creó en el paso anterior.
    \item Suponemos que el archivo de configuración es llamado dspace-angular.json
      \begin{block}{Iniciando la interfaz}
        \center
        pm2 start dspace-angular.json
      \end{block}
    \item En este punto, la interfaz de usuario debería estar disponible en la URL que configuró en su archivo \textit{environment.prod.ts}.
    \item Puede compararla con la interfaz de ejemplo que puede encontrar en la siguiente liga: \url{https://demo7.dspace.org/}
  \end{itemize}
\end{frame}

\subsection{Configuraciones Adicionales}
\begin{frame}[t]
  \frametitle{Configuraciones Adicionales}
  \begin{itemize}
    \item Las configuraciones adicionales de la interfaz de usuario se describen en \textit{environment.common.ts}.
    \item De igual forma puede encontrar mas opciones de configuración y mayor información sobre el funcionamiento de DSpace en la siguiente liga: \url{https://github.com/DSpace/dspace-angular/blob/main/docs/Configuration.md}
  \end{itemize}
\end{frame}

\section{Referencias}
\begin{frame}[t]
  \frametitle{Referencias}
  \begin{itemize}
    \item Guía de Instalación de DSpace: \url{https://wiki.lyrasis.org/display/DSDOC7x/Installing+DSpace}
    \item Opciones extra de configuración: \url{https://github.com/DSpace/dspace-angular/blob/main/docs/Configuration.md}
    \item Repositorio de DSpace-Angular: \url{https://github.com/DSpace/dspace-angular}
    \item Repositorio de DSpace: \url{https://github.com/DSpace/DSpace}
    \item OpenJDK: \url{http://openjdk.java.net/}
    \item Apache Maven: \url{https://maven.apache.org/}
    \item PostgreSQL: \url{https://www.postgresql.org/}
    \item Apache Solr: \url{https://solr.apache.org/}
    \item Apache Tomcat: \url{http://tomcat.apache.org/}
    \item Node.js: \url{https://nodejs.org/en/}
    \item Yarn: \url{https://yarnpkg.com/}
    \item PM2: \url{https://pm2.keymetrics.io/}
  \end{itemize}
\end{frame}

\end{document}
